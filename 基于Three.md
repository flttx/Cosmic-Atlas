基于Three.js的Web3D宇宙探索平台设计文档（Vercel部署版）
 
文档信息
 
项目名称 基于Three.js的Web3D宇宙探索平台 
文档版本 V1.0 
编写日期 [填写日期] 
适用范围 前端开发、3D可视化开发、测试、运维部署 
核心对标 Celestia，轻量化Web版无缝宇宙漫游 
部署目标 Vercel（静态站点+Edge Functions） 
 
一、项目概述
 
1.1 项目背景
 
参考开源宇宙模拟软件Celestia的核心能力，打造一款免安装、纯网页访问的3D宇宙探索平台，支持从行星表面到星系尺度的无缝缩放、天体观测与自定义天体添加。项目基于Three.js引擎开发，部署于Vercel平台，无需自建服务器，降低运维成本，满足天文科普、教学演示、个人兴趣探索等需求。
 
1.2 项目目标
 
1. 构建支持米级（行星表面）到光年级（星系） 无缝缩放的3D宇宙场景，还原天体真实运动规律。
2. 实现天体定位、信息展示、自定义模型上传、场景保存分享等核心功能。
3. 适配Vercel部署规范，支持静态资源CDN分发、Edge Functions跨域转发，保障多端流畅访问。
4. 采用公开合规的天文数据源，避免依赖本地服务（如OpenSpace），实现纯前端轻量化运行。
 
1.3 核心特性
 
特性 描述 
无缝漫游 鼠标/触控操作实现视角旋转、平移、缩放，无尺度切换断层 
真实数据驱动 基于NASA/JPL公开数据，实现行星公转、自转等运动模拟 
自定义扩展 支持用户上传glTF/GLB格式3D模型，配置天体参数 
轻量化部署 静态资源托管于Vercel CDN，Edge Functions解决API跨域问题 
多端兼容 支持PC、平板、手机等设备，主流浏览器无插件访问 
 
二、需求分析
 
2.1 目标用户
 
- 天文爱好者：追求真实宇宙模拟，可自定义天体与探索场景。
- 教育工作者：用于课堂教学演示，直观展示天体运动与宇宙结构。
- 普通用户：通过简单操作体验宇宙漫游，获取基础天文知识。
 
2.2 功能需求
 
2.2.1 3D场景渲染模块
 
功能点 详细需求 
宇宙基底构建 1. 基于Three.js创建星空背景，随机生成差异化恒星（亮度、大小） 2. 实现深空雾效，模拟宇宙空间距离感 3. 支持背景亮度调节，适配不同显示设备 
天体渲染 1. 内置太阳系八大行星、卫星等基础天体，加载NASA高精度纹理贴图 2. 基于JPL轨道参数，实现天体自转、公转的真实运动模拟 3. 支持天体光影效果（如日照明暗面、日食/月食模拟） 
无缝缩放 1. 支持尺度自适应切换，从行星表面平滑过渡到星系视角 2. 限制最小/最大缩放比例，避免性能损耗或视觉异常 
 
2.2.2 交互控制模块
 
功能点 详细需求 
基础视角操作 1. 鼠标：左键旋转、右键平移、滚轮缩放 2. 触控：单指旋转、双指缩放/平移 3. 提供“视角重置”“太阳系概览”快捷按钮 
天体快速定位 1. 搜索框支持模糊查询，输入天体名称/拼音首字母匹配目标 2. 定位后自动切换至天体特写视角，显示轨道辅助线 3. 支持坐标输入定位（如赤道坐标、黄道坐标） 
天体信息展示 1. 点击天体弹出信息面板，展示名称、直径、质量、与地球距离、公转周期等数据 2. 面板支持收起/展开，不遮挡核心场景视图 3. 提供外部科普链接跳转（如NASA天体百科） 
 
2.2.3 自定义扩展模块
 
功能点 详细需求 
自定义天体上传 1. 支持上传glTF/GLB格式3D模型，文件大小限制≤50MB 2. 提供参数配置界面：设置天体类型（行星/恒星/航天器）、自转速度、轨道半径、公转周期 3. 支持自定义纹理贴图上传（PNG/JPG格式，分辨率≤2K） 
场景保存与分享 1. 支持将当前场景（视角、天体配置、自定义模型）保存为JSON文件，本地导出 2. 生成场景分享链接，他人点击可直接加载相同场景（基于Vercel KV存储可选） 3. 提供“我的场景”管理页面，支持查看、编辑、删除 
 
2.2.4 科普辅助模块
 
功能点 详细需求 
预设科普场景 1. 内置至少5个预设场景：太阳系漫游、银河系结构、星座展示、行星对比、航天器飞行模拟 2. 每个场景附带文字讲解，支持自动漫游模式（按预设路径展示天体） 
轨道辅助显示 1. 可切换显示/隐藏天体公转轨道线，轨道线颜色支持自定义 2. 标注轨道名称（如“地球公转轨道”），辅助教学理解 
 
2.3 非功能需求
 
2.3.1 性能需求
 
1. 加载性能：100Mbps网络下，首次加载≤10秒，二次加载≤3秒（基于缓存）。
2. 帧率要求：主流PC（i5+GTX 1050）帧率≥30FPS；移动端（骁龙8系）帧率≥25FPS。
3. 渲染能力：同时显示≥50个天体时无明显卡顿。
 
2.3.2 兼容性需求
 
1. 浏览器兼容：Chrome 90+、Firefox 88+、Edge 90+，不支持IE。
2. 设备兼容：支持PC、平板、手机，自适应屏幕分辨率（响应式布局）。
3. 无插件依赖：纯网页运行，无需安装额外软件。
 
2.3.3 安全需求
 
1. 文件上传校验：仅允许glTF/GLB/PNG/JPG格式，防止恶意文件上传。
2. 跨域安全：配置Vercel CORS策略，仅允许指定域名请求。
3. 数据隐私：用户上传的模型与场景默认本地存储，不上传至服务器（除非主动分享）。
 
2.3.4 部署需求
 
1. 适配Vercel静态站点规范，支持CI/CD自动部署（关联GitHub仓库）。
2. 静态资源（模型、纹理、数据）托管于Vercel CDN，配置长期缓存策略。
3. 利用Edge Functions解决JPL等公开API的跨域问题，无需自建后端。
 
三、技术架构设计
 
3.1 技术栈选型
 
技术领域 选型方案 用途说明 
3D引擎 Three.js r150+ 核心3D场景渲染、天体运动模拟 
前端框架 Vue3 页面组件开发、状态管理 
状态管理 Pinia 管理用户场景、天体配置等状态 
构建工具 Vite 快速构建、热更新，优化打包体积 
辅助库 OrbitControls 视角旋转、平移、缩放控制 
 GLTFLoader 加载glTF/GLB格式3D模型 
 Tween.js 实现平滑视角过渡、天体运动动画 
部署平台 Vercel 静态站点托管、Edge Functions、CDN分发 
数据存储 localStorage 本地存储用户场景配置 
 Vercel KV（可选） 存储分享场景数据，生成分享链接 
 
3.2 架构总览
 
1. 前端渲染层：基于Three.js构建3D宇宙场景，实现视角控制、天体渲染、动画模拟；Vue3负责页面UI组件（搜索框、信息面板、自定义配置页）。
2. 数据层：分为静态资源（模型、纹理、预设场景数据）和动态数据（JPL轨道参数、恒星位置数据），静态资源托管于Vercel CDN，动态数据通过Edge Functions转发获取。
3. 部署层：Vercel托管静态HTML/CSS/JS资源，Edge Functions处理API跨域请求，实现无后端轻量化部署。
 
3.3 核心模块设计
 
3.3.1 3D场景渲染模块
 
1. 场景初始化：创建Three.js场景、相机（PerspectiveCamera）、渲染器（WebGLRenderer），配置抗锯齿、设备像素比适配。
2. 星空背景生成：通过粒子系统生成随机恒星，结合雾效模拟深空效果。
3. 天体加载流程：
plaintext
  
加载NASA glTF模型 → 绑定纹理贴图 → 读取JPL轨道参数 → 编写运动算法（自转/公转） → 添加到场景
 
4. 无缝缩放实现：监听滚轮事件，动态调整相机视角范围和天体显示级别（近距显示天体细节，远距显示天体缩略）。
 
3.3.2 Edge Functions跨域转发模块
 
针对JPL Horizons等公开API的跨域限制，在Vercel中创建Edge Functions函数，转发前端请求并添加CORS头。
 
- 函数路径： api/horizons.js 
- 核心功能：接收前端天体查询参数，转发请求至JPL API，返回JSON格式数据，解决跨域问题。
 
3.3.3 自定义模型处理模块
 
1. 文件上传校验：前端校验文件格式和大小，后端（Edge Functions）二次校验，防止非法文件。
2. 模型加载与参数绑定：通过GLTFLoader加载用户上传的模型，提供可视化界面配置轨道、自转等参数，生成自定义天体实例。
3. 场景序列化：将场景中所有天体的位置、参数、自定义模型路径序列化为JSON，支持本地导出与导入。
 
四、数据源与资源管理
 
4.1 数据源清单（替代OpenSpace）
 
数据类型 推荐来源 获取方式 格式 用途 
3D天体模型 NASA 3D Resources 直接下载 glTF/GLB 行星、卫星、航天器模型 
天体纹理 NASA Visible Earth 直接下载 PNG/JPG 行星表面高精度纹理 
轨道参数 JPL Horizons Web API Edge Functions转发 JSON/文本 天体自转、公转运动模拟 
恒星位置数据 Gaia DR3数据库 下载转换为JSON JSON 构建银河系恒星背景 
小行星数据 Minor Planet Center 下载转换为JSON JSON 小行星带模拟 
 
4.2 资源管理规范
 
1. 格式标准化：所有3D模型统一为glTF/GLB格式，纹理分辨率≤2K，单个模型体积≤5MB。
2. 轻量化处理：
- 用Blender对模型减面（行星≤10k面，航天器≤50k面）。
- 用 gltf-pipeline 压缩模型，用TinyPNG压缩纹理。
3. 分类存储：静态资源放入项目 public 目录，结构如下：
plaintext
  
public/
├── models/  # 3D模型
│   ├── solar-system/  # 太阳系天体
│   └── spacecraft/  # 航天器
├── textures/  # 纹理贴图
└── data/  # 预设场景、天文参数JSON
 
4. 版本控制：模型与纹理资源纳入Git版本管理，大文件使用Git LFS。
 
五、Vercel部署设计
 
5.1 部署配置
 
1. 项目构建：使用Vite打包项目，输出目录为 dist 。
2. vercel.json配置：设置路由规则、缓存策略、CORS头，示例如下：
json
  
{
  "build": {
    "src": "package.json",
    "use": "@vercel/static-build",
    "config": { "distDir": "dist" }
  },
  "headers": [
    {
      "source": "/models/(.*)",
      "headers": [{"key": "Cache-Control", "value": "public, max-age=31536000"}]
    },
    {
      "source": "/api/(.*)",
      "headers": [{"key": "Access-Control-Allow-Origin", "value": "*"}]
    }
  ]
}
 
3. CI/CD配置：关联GitHub仓库，开启自动部署，代码提交后自动触发构建部署。
 
5.2 部署流程
 
1. 本地开发完成后，推送代码至GitHub仓库。
2. Vercel自动检测代码更新，触发构建流程。
3. 构建完成后，生成访问域名（默认 xxx.vercel.app ），支持绑定自定义域名。
 
六、测试与验收标准
 
6.1 功能测试
 
测试项 验收标准 
场景渲染 太阳系天体渲染正常，纹理清晰，自转公转运动符合真实参数 
视角控制 鼠标/触控操作流畅，无缝缩放无断层，视角重置功能正常 
天体定位 搜索框输入名称可精准定位，信息面板数据正确 
自定义上传 支持glTF/GLB模型上传，参数配置后天体运动正常 
场景保存 导出JSON文件可正常导入，恢复原有场景配置 
 
6.2 性能测试
 
测试项 验收标准 
加载速度 100Mbps网络下，首次加载≤10秒，二次加载≤3秒 
帧率 PC端帧率≥30FPS，移动端帧率≥25FPS 
多天体渲染 同时显示50个天体时无卡顿、无崩溃 
 
6.3 部署测试
 
1. 访问Vercel生成的域名，页面正常加载，无404错误。
2. 调用Edge Functions接口，跨域请求正常返回数据。
3. 多设备、多浏览器访问，功能与性能符合预期。
 
